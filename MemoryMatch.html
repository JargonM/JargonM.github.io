<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Match</title>
    <link rel="stylesheet" href="styles/styles.css">
    <style>
        .tile{
            font-size: xx-large;
            width: 50px;
            height: 50px;
            line-height: 50px;
            background-color: gray;
            text-align: center;
        }
        td {
            width: 55px;
            height: 55px;
        }



    </style>
</head>
<body>
    <h1> Welcome to the Memory Match Game</h1>
    <p><button onclick='gameReset()'>Reset Game</button></p>
    <div id='gameBoard'></div>

    <script>
        let map = [];//will be a 2d array
       let rows;
       let cols;
        //console.log(map);

        let tile1 = null, tile2 = null;

        //create function to load the map

 //shuffle the map array
 const shuffle = (array) => {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        let temp = array[i];
        array[i] = array[j];
        array[j] = temp;
    }
    return array;
}



//load the map with pairs of numbers and shuffle them
        const loadMap = (rows, cols) =>{
            let maxTiles = rows * cols;
            let maxPairs = maxTiles / 2;
            //create array of pairs
            let nums = [];
            for(let i = 0; i < maxPairs; i++){
                nums.push(i + 1);
                nums.push(i + 1);
            }

            shuffle(nums);
            console.log(shuffle(nums));
        

        
        
            //put shuffled numbers into 2d array
            let index = 0;
            for(let r = 0; r < rows; r++){
                map[r] = [];
                for(let c = 0; c < cols; c++){
                    map[r][c] = nums[index];
                    index++;
                }
            }
            console.log(map);
        
        }




//check if the two selected tiles match  
    
  const checkMatch = () => {
if(tile1.innerHTML == tile2.innerHTML){
        tile1.hidden = true;
        tile2.hidden = true;
}
tile1.innerHTML = '';
tile2.innerHTML = '';
tile1 = tile2 = null;

//say game over if all tiles are hidden
const tiles = document.getElementsByClassName('tile');
let win = true;
for(let tile of tiles){
    if(!tile.hidden){
        win = false;
        break;
    }
}    
  if(win){
    alert('YOU WIN!');
  } 

} 


//process the tile clicked, called from onclick event in makeBoard
const process = (row, col) => {
    let clicked_tile = document.getElementById(row + '_' + col);

    //clicked tile not already contains data
    if(!Boolean(clicked_tile.innerHTML)){
                
        //tile 1 not yet selected
        if(!tile1){
            tile1 = clicked_tile;
            clicked_tile.innerHTML = map[row][col];
        }
        //tile 2 net yet selected
        else if(!tile2){
            tile2 = clicked_tile;
            clicked_tile.innerHTML = map[row][col];
        }
    }
    //set timeout callback function
    if(tile1 && tile2){
        setTimeout(checkMatch, 500);

    }

    
    
}



//create board using rows and cols
  const makeBoard = (rows, cols) =>  {
        let output = "<table>";
        for(let row = 0; row < rows; row++){
            output += '<tr>';
            for(let col = 0; col < cols; col++){
                    output += '<td><button' + 
                        ' class="tile"' +
                        ' id="' + row + '_' + col + '"' +
                        ' onclick="process(' + row + ',' + col + ')">' +
                        '</button></td>';
                }
            output += '</tr>';
        }
       
        document.getElementById('gameBoard').innerHTML = output + '</table>';
    }


        



//resets the game
        const gameReset = () =>{
            loadMap(4,4);
            makeBoard(4,4);
        }

    </script>


        <p>Back to Home Page: <a href='index.html' > Home Page</a></p>

    
</body>
</html>